<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browser</title>

    <style>
        /* üé® Color variables (default = light mode) */
        :root {
            --bg-color: #ffffff;
            --text-color: #111111;
            --title-color: #f3b407;
            --card-bg: #ffffff;
            --placeholder-color: #3f3e3e;
            --shadow-color: rgba(17, 17, 17, 0.2);
            --mic-border: #eca50b;
            --suggestion-text: #555555;
        }

        /* üåô Dark mode (auto, based on user/system setting) */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-color: #050505;
                --text-color: #f5f5f5;
                --title-color: #f3c64a;
                --card-bg: #111111;
                --placeholder-color: #9a9a9a;
                --shadow-color: rgba(0, 0, 0, 0.8);
                --mic-border: #f0b93a;
                --suggestion-text: #cccccc;
            }
        }

        body {
            margin: 0;
            height: 100vh;
            background: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            font-family: Arial, sans-serif;
            padding-top: 120px;
        }

        .title {
            font-size: 85px;
            font-weight: bold;
            color: var(--title-color);
            letter-spacing: -2px;
            margin-bottom: 45px;
        }

        .search-box {
            width: 90%;
            max-width: 600px;
            background: var(--card-bg);
            border-radius: 50px;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 2px 6px var(--shadow-color);
            transition: box-shadow 0.2s ease, transform 0.2s ease; /* üîπ focus animation */
        }

        /* üîπ Focused state for search box */
        .search-box.focused {
            box-shadow: 0 4px 14px var(--shadow-color);
            transform: translateY(-1px);
        }

        #searchInput {
            flex: 1;
            font-size: 17px;
            border: none;
            outline: none;
            background: transparent;
            color: var(--text-color);
        }

        #searchInput::placeholder {
            color: var(--placeholder-color);
            transition: color 0.2s ease, opacity 0.15s ease; /* halka smooth feel */
        }

        .mic-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--card-bg);
            border: 2px solid var(--mic-border);
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: transform 0.18s ease, box-shadow 0.18s ease, background 0.18s ease, border-color 0.18s ease;
        }

        /* üîπ Mic hover / tap animation */
        .mic-icon:hover {
            transform: scale(1.08);
            box-shadow: 0 0 8px var(--shadow-color);
        }

        .mic-icon:active {
            transform: scale(0.96);
            box-shadow: 0 0 4px var(--shadow-color);
        }

        .google-mic {
            position: relative;
            width: 6px;
            height: 10px;
            background: var(--text-color);
            border-radius: 999px;
            top: -1px;
        }

        .google-mic::before {
            content: "";
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            top: 6px;
            width: 10px;
            height: 5px;
            border: 1.5px solid var(--text-color);
            border-top: none;
            border-radius: 0 0 8px 8px;
        }

        .google-mic::after {
            content: "";
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            top: 11px;
            width: 2px;
            height: 4px;
            background: var(--text-color);
            border-radius: 2px;
        }

        /* Clear (X) button */
        #clearBtn {
            border: none;
            background: transparent;
            font-size: 16px;
            cursor: pointer;
            display: none; /* default me hidden */
            padding: 0 4px;
            line-height: 1;
            color: var(--placeholder-color);
        }

        /* Niche suggestion box */
        #suggestionBox {
            width: 90%;
            max-width: 600px;
            font-size: 14px;
            color: var(--suggestion-text);
            margin-top: 8px;
            font-family: Arial, sans-serif;
            opacity: 0;                     /* üîπ animation default */
            transform: translateY(4px);     /* halka neeche */
            transition: opacity 0.18s ease, transform 0.18s ease;
        }

        /* üîπ Visible state for suggestion (fade + slide-up) */
        #suggestionBox.show {
            opacity: 1;
            transform: translateY(0);
        }

        #suggestionBox span.query {
            font-weight: bold;
            color: var(--text-color);
        }

        /* üéß Mic listening state ‚Äì soft pulsing circle, icon visible */
        .mic-icon.listening {
            background: #ffe8b3;
            border-color: var(--mic-border);
            animation: mic-pulse 1s ease-in-out infinite;
            box-shadow: 0 0 0 0 rgba(236,165,11,0.4);
        }

        @keyframes mic-pulse {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(236,165,11,0.4);
            }
            50% {
                transform: scale(1.08);
                box-shadow: 0 0 0 8px rgba(236,165,11,0);
            }
            100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(236,165,11,0.0);
            }
        }

        /* Mobile view thoda compact */
        @media (max-width: 600px) {
            body {
                padding-top: 80px;
            }
            .title {
                font-size: 60px;
            }
        }
    </style>
</head>

<body>

    <div class="title">Browser</div>

    <div class="search-box">

        <div class="mic-icon" onclick="startVoice()">
            <div class="google-mic"></div>
        </div>

        <input
            id="searchInput"
            type="text"
            placeholder="Search anything or type a URL"
            autofocus>

        <button id="clearBtn" type="button" aria-label="Clear search">√ó</button>
    </div>

    <div id="suggestionBox"></div>

    <script>
        const searchInput = document.getElementById("searchInput");
        const micIcon = document.querySelector(".mic-icon");
        const clearBtn = document.getElementById("clearBtn");
        const suggestionBox = document.getElementById("suggestionBox");
        const searchBox = document.querySelector(".search-box"); // üîπ for focus animation

        const DEFAULT_PLACEHOLDER = "Search anything or type a URL";
        let recognition = null; // upar define, niche assign

        // ‚úÖ Valid TLD list for URL check
        const VALID_TLDS = [
            "com","in","net","org","co","io","gov","edu",
            "info","xyz","me","online","live","tech","site",
            "shop","store","app","dev","tv","ai"
        ];

        // ‚úÖ Check kare ki text "likely URL" hai ya nahi
        function isLikelyUrl(text) {
            const query = text.trim();

            if (!query) return false;

            // Agar space hai ‚Üí URL mat maano
            if (query.includes(" ")) return false;

            // Agar already http/https se start hai ‚Üí URL hi hai
            if (query.startsWith("http://") || query.startsWith("https://")) {
                return true;
            }

            // Sirf domain part lo (path ke pehle tak)
            const domainPart = query.split("/")[0];

            // Dot hona chahiye (jaise example.com)
            if (!domainPart.includes(".")) return false;

            const parts = domainPart.split(".");
            if (parts.length < 2) return false;

            const tld = parts[parts.length - 1].toLowerCase();

            // Agar TLD hamari list me hai to URL maante hain
            return VALID_TLDS.includes(tld);
        }

        // ‚úÖ Common URL builder (ab smart URL check ke saath)
        function buildUrl(text) {
            let query = text.trim();
            if (!query) return null;

            if (isLikelyUrl(query)) {
                // URL hai
                if (!query.startsWith("http://") && !query.startsWith("https://")) {
                    query = "https://" + query;
                }
                return query;
            } else {
                // URL nahi ‚Üí Google search
                return "https://www.google.com/search?q=" + encodeURIComponent(query);
            }
        }

        // ‚úÖ Keyboard se search (Enter) ‚Üí same tab + Opening/Searching text
        function runSearchFromKeyboard() {
            const text = searchInput.value.trim();
            const url = buildUrl(text);
            if (!url) return;

            if (isLikelyUrl(text)) {
                suggestionBox.innerHTML = `Opening: <span class="query">${url}</span>`;
            } else {
                suggestionBox.innerHTML = `Searching for: <span class="query">${text}</span>`;
            }

            // üîπ show animation for suggestion
            suggestionBox.classList.add("show");

            window.location.href = url; // SAME TAB
        }

        // ‚úÖ Mic se search ‚Üí same tab, auto (Enter ki zarurat nahi)
        function runSearchFromVoice(text) {
            const spoken = text.trim();
            const url = buildUrl(spoken);
            if (!url) return;

            if (isLikelyUrl(spoken)) {
                suggestionBox.innerHTML = `Opening: <span class="query">${url}</span>`;
            } else {
                suggestionBox.innerHTML = `Searching for: <span class="query">${spoken}</span>`;
            }

            // üîπ show animation for suggestion
            suggestionBox.classList.add("show");

            // Listening khatam, placeholder normal
            searchInput.placeholder = DEFAULT_PLACEHOLDER;

            window.location.href = url; // same tab, popup block nahi
        }

        // ENTER se normal search
        searchInput.addEventListener("keydown", function (e) {
            if (e.key === "Enter" || e.keyCode === 13) {
                runSearchFromKeyboard();
            }
        });

        // üîπ Focus/blur par search-box animation
        searchInput.addEventListener("focus", function () {
            if (searchBox) {
                searchBox.classList.add("focused");
            }
        });

        searchInput.addEventListener("blur", function () {
            if (searchBox) {
                searchBox.classList.remove("focused");
            }
        });

        // Type karte waqt niche text + mic on ho to off kar do
        searchInput.addEventListener("input", function () {
            const text = this.value.trim();
            updateSuggestion(text);

            // Clear button show/hide
            if (text.length > 0) {
                clearBtn.style.display = "inline";
            } else {
                clearBtn.style.display = "none";
            }

            // Agar user type kare ‚Üí mic listening band + placeholder normal + border normal
            if (micIcon && micIcon.classList.contains("listening")) {
                micIcon.classList.remove("listening");
            }
            if (micIcon) {
                micIcon.style.borderColor = "#eca50b";
            }
            searchInput.placeholder = DEFAULT_PLACEHOLDER;

            if (recognition) {
                try {
                    recognition.stop();
                } catch (e) {
                    // ignore
                }
            }
        });

        function updateSuggestion(text) {
            if (!text) {
                suggestionBox.innerHTML = "";
                suggestionBox.classList.remove("show"); // üîπ hide animation
                return;
            }
            suggestionBox.innerHTML = `Search for: <span class="query">${text}</span>`;

            // üîπ trigger animation
            requestAnimationFrame(() => {
                suggestionBox.classList.add("show");
            });
        }

        // ‚ùå Clear button click ‚Üí text + suggestion clear
        clearBtn.addEventListener("click", function () {
            searchInput.value = "";
            suggestionBox.innerHTML = "";
            suggestionBox.classList.remove("show"); // üîπ hide
            clearBtn.style.display = "none";
            searchInput.placeholder = DEFAULT_PLACEHOLDER;

            // Safety: mic ko normal state me rakho
            if (micIcon) {
                micIcon.classList.remove("listening");
                micIcon.style.borderColor = "#eca50b";
            }
            if (recognition) {
                try {
                    recognition.stop();
                } catch (e) {}
            }
        });

        // üé§ VOICE SEARCH
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

        if (SpeechRecognition) {
            recognition = new SpeechRecognition();
            recognition.lang = "en-IN";
            recognition.interimResults = false;
            recognition.continuous = false;

            recognition.onresult = function (event) {
                const transcript = event.results[0][0].transcript;
                searchInput.value = transcript;

                // Mic se bola ‚Üí text set ‚Üí bina Enter dabaye direct search
                runSearchFromVoice(transcript);
            };

            // üéß Mic khatam hone par listening state hatao
            recognition.onend = function () {
                if (micIcon) {
                    micIcon.classList.remove("listening");
                    micIcon.style.borderColor = "#eca50b";
                }
            };

            recognition.onerror = function (event) {
                console.error("Voice error:", event.error);
                if (micIcon) {
                    micIcon.classList.remove("listening");
                    micIcon.style.borderColor = "red"; // error pe red border
                }

                // Placeholder me hi error message
                searchInput.placeholder = "Mic access is blocked. Please allow mic to use voice search.";

                // Suggestion box clear (optional)
                suggestionBox.innerHTML = "";
                suggestionBox.classList.remove("show"); // üîπ hide
            };
        }

        function startVoice() {
            if (!recognition) {
                alert("Voice search is not supported in this browser.");
                return;
            }
            if (micIcon) {
                micIcon.classList.add("listening"); // circle pulse animation ON
                micIcon.style.borderColor = "#eca50b"; // normal color
            }
            searchInput.placeholder = "Listening...";
            recognition.start();
        }
    </script>

</body>
</html>
